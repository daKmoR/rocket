{% if content.jsCode %}
  <script type="module">
    {{ content.jsCode | safe }}
  </script>
{% endif %}

{% if site.analytics %}
  <script type="module">
    window.ga = window.ga || ((...args) => (ga.q = ga.q || []).push(args));

    ga('create', '{{ site.analytics }}', 'auto');
    ga('set', 'transport', 'beacon');
    ga('send', 'pageview');
  </script>
  <script async="async" src="https://www.google-analytics.com/analytics.js"></script>
{% endif %}

<script>
  if ('serviceWorker' in navigator) {
    let refreshing;
    navigator
      .serviceWorker
      .addEventListener('controllerchange', () => {
        if (refreshing) {
          return;
        }
        refreshing = true;
        window
          .location
          .reload();
      });
  }
</script>
